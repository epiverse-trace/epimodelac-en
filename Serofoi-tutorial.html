<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Outbreak Analytics and Modelling in Public Health: Estimation of force of infection from serological surveys using serofoi</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epitkit/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/epitkit/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/epitkit/favicon-16x16.png"><link rel="manifest" href="favicons/epitkit/site.webmanifest"><link rel="mask-icon" href="favicons/epitkit/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epitkit"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epitkit-logo" alt="epitkit" src="assets/images/epitkit-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/Serofoi-tutorial.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epitkit" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epitkit" src="assets/images/epitkit-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Outbreak Analytics and Modelling in Public Health
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Outbreak Analytics and Modelling in Public Health
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Outbreak Analytics and Modelling in Public Health
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 0%" class="percentage">
    0%
  </div>
  <div class="progress epitkit">
    <div class="progress-bar epitkit" role="progressbar" style="width: 0%" aria-valuenow="0" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/Serofoi-tutorial.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        1. Estimation of force of infection from serological surveys using serofoi
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">1. Introduction</a></li>
<li><a href="#objectives">2. Objectives</a></li>
<li><a href="#basic-concepts-to-be-developed">3. Basic concepts to be developed</a></li>
<li><a href="#bayesian-models">3.2. Bayesian models</a></li>
<li><a href="#reflection">5. Reflection</a></li>
<li><a href="#references">References</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Estimation of force of infection from serological surveys using serofoi</h1>
        <p>Last updated on 2025-06-26 |

        <a href="https://github.com/epiverse-trace/epimodelac-en/edit/main/episodes/Serofoi-tutorial.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How to retrospectively estimate the <em>Force of Infection</em> of a
pathogen from <em>age-disaggregated population-based serological
prevalence surveys</em> by implementing <em>Bayesian models</em> using
<strong>serofoi</strong>?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>At the end of this workshop you will be able to:</p>
<ul><li><p>Explore and analyze a typical serological survey.</p></li>
<li><p>Learn how to estimate the Infection Strength in a specific use
case.</p></li>
<li><p>Visualize and interpret the results.</p></li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><!-- Here you are expected to share information about a public health problem. The methodology is case resolution.
(It is also possible to ask participants to describe the database).
--><p><strong>serofoi</strong> is an R package for retrospectively
estimating the <em>Force of Infection</em> of a pathogen from
<em>age-disaggregated population-based serological prevalence
surveys</em> by implementing <em>Bayesian models</em>. For this purpose,
<strong>serofoi</strong> uses the <em>Rstan</em> package, which provides
an interface to the statistical programming language <em>Stan</em>,
through which Monte-Carlo methods based on Markov chains are
implemented.</p>
<p>As a particular case, we will study an outbreak of Chikungunya, a
viral disease discovered in Tanzania in 1952 that is characterized by
severe fevers, joint pain, headache, rashes, among other symptoms. Since
2013, cases of this disease began to be reported in the Americas and
since then the disease has been endemic in several Latin American
countries. During this tutorial, we will analyze a serological survey
conducted between October and December 2015 in Bahia, Brazil, which was
conducted shortly after an epidemic of this disease, in order to
characterize the endemic or epidemic patterns in the area.</p>
</section><section><h2 class="section-heading" id="objectives">2. Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a></h2>
<hr class="half-width"><!-- Here you are expected to include the objectives of the workshop. What do you expect the students to learn from the workshop? What are the students expected to be able to do at the end of the workshop? Objectives should begin with an infinitive verb. --><ul><li><p>Explore and analyze a typical serological survey.</p></li>
<li><p>Learn how to estimate the Infection Strength in a specific use
case.</p></li>
<li><p>Visualize and interpret the results.</p></li>
</ul></section><section><h2 class="section-heading" id="basic-concepts-to-be-developed">3. Basic concepts to be developed<a class="anchor" aria-label="anchor" href="#basic-concepts-to-be-developed"></a></h2>
<hr class="half-width"><!-- The following concepts will be developed in this practice: --><!-- Here you are expected to mention the most important concepts of the workshop (must be technical concepts that can be found in the literature) --><p>The following concepts will be developed in this practice:</p>
<ul><li><p>Serological surveys (<em>sero</em>)</p></li>
<li><p>Infection strength (<em>foi</em>)</p></li>
<li><p>Serocatalytic models</p></li>
<li><p>Bayesian Statistics</p></li>
<li><p>Visualization and interpretation of FoI model results</p></li>
</ul><p>The Force of Infection (FoI), also known as the risk rate or
infection pressure, represents the rate at which susceptible individuals
become infected given exposure to a pathogen. In other words, FoI
quantifies the risk of a susceptible individual becoming infected over a
period of time.</p>
<p>As we will see below, this concept is key in modeling infectious
diseases. To illustrate the concept, let us consider a population
exposed to a pathogen and call <span class="math inline">\(P(t)\)</span>
the proportion of individuals that have been infected at time <span class="math inline">\(t\)</span>. Assuming no sero-reversion, the
quantity <span class="math inline">\(1 - P(t)\)</span> represents the
number of individuals susceptible to the disease, such that the rate of
infection is given by:</p>
<p><span class="math display">\[
\tag{1} \frac{dP(t)}{d t} = \lambda(t) (1- P(t)),
\]</span></p>
<p>where <span class="math inline">\(lambda(t)\)</span> represents the
rate at which susceptible individuals become infected per unit time
(days, months, years, …), i.e. FoI. The differential equation (1)
resembles that of a chemical reaction where <span class="math inline">\(P(t)\)</span> represents the proportion of
substrate that has not come into contact with a catalytic reagent, so
these types of models are known as <strong>serocatalytic models</strong>
(Muench, 1959).</p>
<p>Despite the simplicity of the model represented by equation (1),
compared to compartmental models (for example), the difficulty in
knowing an initial condition for seropositivity at some point in the
past makes its practical use impossible. To circumvent this limitation,
it is common to apply the model for age cohorts rather than for the
total population. To do this, let us label each age cohort according to
its year of birth <span class="math inline">\(tau\)</span>, and assume
that individuals are seronegative at birth:</p>
<p><span class="math display">\[ \frac{dP^\tau (t)}{dt} = \lambda(t) (1
- P^\tau(t)).
\]</span></p>
<p>With initial conditions given by <span class="math inline">\(P^\tau(\tau) = 0\)</span>. This equation can be
solved analytically, yielding the result (Hens et al, 2010):</p>
<p><span class="math display">\[ P^{\tau} (t) = 1 -
\exp\left(-\int_{\tau}^{t} \lambda (t') dt' \right).
\]</span></p>
<p>Assuming that FoI remains constant throughout each year, the discrete
version of this equation is:</p>
<p><span class="math display">\[ \tag{2} P^\tau(t) = 1 -
\exp\left(-\sum_{i = \tau}^{t} \lambda_i \right),
\]</span></p>
<p>As an example, consider the FoI represented in the following
figure:</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>From this FoI, it is possible to calculate the seroprevalence for
different cohorts by means of equation (2):</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>When we know the data from a serological survey, the information we
have access to is a snapshot of the seroprevalence at the time <span class="math inline">\(t_{sur}\)</span> as a function of the age of the
individuals at that time, which coincides with equation (2) since
individuals age at the same rate as time passes; that is:</p>
<p><span class="math display">\[
\tag{3}
P^{t_{sur}}(a^\tau) = 1 - \exp\left(-\sum_{i = \tau}^{t_{sur}} \lambda_i
\right).
\]</span></p>
<p>In the case of the example, this gives us the following graph:</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that the seroprevalence values for each age in this graph
correspond to the seroprevalence values at the time of the survey (2020)
in the previous graph.</p>
<p>The mission that <strong>serofoi</strong> fulfills is to estimate the
historical force of infection <span class="math inline">\("tambda(t)\)</span> from this snapshot of the
serologic profile of the population at the time of the survey. for which
serologic surveys that meet the following inclusion criteria are
required:</p>
<ul><li>Population-based (non-hospital).</li>
<li>Cross-sectional study (single time).</li>
<li>Indicate the diagnostic test used.</li>
<li>Identifying the patient’s age at the time of the survey.</li>
</ul><p>In cases where FoI can be considered constant, equation (3) gives the
result:</p>
<p><span class="math display">\[
\tag{4}
P_{sur}(a^\tau(t_{sur})) = 1 - \exp (-\lambda a^\tau),
\]</span></p>
<p>where it was taken into account that, at the time of pathogen
introduction (<span class="math inline">\(t = 0\)</span>), the
proportion of infected individuals was <span class="math inline">\(P(0)
= 0\)</span> (initial condition). Note that the summation term in
equation (3) results in the age of each cohort when considering constant
force of infection.</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>Figure 1.</strong> Prevalence curves as a function of age for
different values of constant FoI.</p>
<p>In this example we have chosen, for simplicity, that the FoI was
constant; however, this is not necessarily the case. Identifying whether
the FoI follows a constant or time-varying trend can be of vital
importance in identifying and characterizing the spread of a disease.
This is where the R <strong>serofoi</strong> package plays an important
role, as it allows to retrospectively estimate the FoI of a pathogen,
thus recovering its temporal evolution, by means of pre-established
Bayesian models.</p>
<p>Current models in the <strong>serofoi</strong> package assume the
following biological assumptions:</p>
<ul><li>No sero-reversion (no loss of immunity).</li>
<li>FoI is not age-dependent.</li>
<li>Low or no levels of migration in the populations.</li>
<li>Small differences between susceptible and infected mortality rates.
infected.</li>
</ul></section><section><h2 class="section-heading" id="bayesian-models">3.2. Bayesian models<a class="anchor" aria-label="anchor" href="#bayesian-models"></a></h2>
<hr class="half-width"><p>Unlike the frequentist approach, where the probability is associated
with the relative frequency of occurrence of events, Bayesian statistics
is based on the use of the conditional probability of events with
respect to the knowledge (or state of information) that we may have
about the data or about the parameters we want to estimate.</p>
<p>In general, when we propose a model what we seek is to reduce the
uncertainty about some parameter, so that we approach its value as
optimally as our previous knowledge of the phenomenon and the
measurements (data) allow us to do.</p>
<p>Bayesian inference is supported by Bayes’ theorem, which states that:
given a data set <span class="math inline">\(\vec{y} = (y_1, ...,
y_N)\)</span>, which represents a single event, and the random variable
<span class="math inline">\(\theta\)</span>, which represents a
parameter of interest to us (in our case, the FoI <span class="math inline">\(\lambda\)</span>), the joint probability
distribution of the associated random variables is given by:</p>
<p><span class="math display">\[ \tag{4}
p(\vec{y}, \theta) = p(\vec{y} | \theta) p(\theta) = p(\theta | \vec{y})
p(\vec{y}),
\]</span></p>
<p>from which we derive the aposteriori distribution of <span class="math inline">\(\theta\)</span>, i.e. an updated version of the
FoI probability distribution conditional on our data:</p>
<p><span class="math display">\[\tag{5}
p(\theta, \vec{y}) =  \frac{p(\vec{y} | \theta) p(\theta)}{p(\vec{y})},
\]</span></p>
<p>The distribution <span class="math inline">\(p(\vec{y} |
\theta)\)</span>, which corresponds to the information internal to the
data conditional on the value of the parameter <span class="math inline">\(\theta\)</span>, is usually determined by the
nature of the experiment: it is not the same to choose balls inside a
box by replacing them than by leaving them outside the box (e.g.). In
the particular case of FoI, we have data such as the total number of
surveys by age and the number of positive cases, so it is reasonable to
assign a binomial distribution to the probability, as we will see
below.</p>
<div class="section level3">
<h3 id="constant-foi-model">3.3.1. Constant FoI model<a class="anchor" aria-label="anchor" href="#constant-foi-model"></a></h3>
<p>In our particular case, the parameter that we want to estimate is the
FoI (<span class="math inline">\(\lambda\)</span>). The apriori
probability distribution of <span class="math inline">\(\lambda\)</span>
represents our informed assumptions or the prior knowledge we have about
the behavior of the FoI. In this context, the state of minimal
information about <span class="math inline">\(\lambda\)</span> is
represented by a uniform distribution:</p>
<p><span class="math display">\[\tag{6}
\lambda \sim U(0, 2),
\]</span></p>
<p>which means that we start from the premise that all values of the
force of infection between <span class="math inline">\(0\)</span> and
<span class="math inline">\(2\)</span> are equally probable. On the
other hand, from the theory of sero-catalytic models we know that
seroprevalence in a given year is described by a cumulative process with
age (Hens et al, 2010):</p>
<p><span class="math display">\[\tag{7}
P(a, t) = 1 - \exp\left(  -\sum_{i=t-a+1}^{t} \lambda_i  \right),
\]</span></p>
<p>where <span class="math inline">\(\lambda_i\)</span> corresponds to
the FoI at time <span class="math inline">\(t\)</span>. Since in this
case the FoI is constant, eq. (7) reduces to:</p>
<p><span class="math display">\[\tag{8}
P(a, t) = 1 - \exp\left(  -\lambda a \right),
\]</span></p>
<p>If <span class="math inline">\(n(a, t_{sur})\)</span> is the number
of age-positive samples obtained in a serological study conducted in the
year <span class="math inline">\(t_{sur}\)</span>, then we can estimate
the distribution of age-positive cases conditional on the value of <span class="math inline">\(t_{sur}\)</span> as a binomial distribution:</p>
<p><span class="math display">\[\tag{9}
p(a, t) \sim Binom(n(a, t), P(a, t)) \\
\lambda \sim U(0, 2)
\]</span></p>
</div>
<div class="section level3">
<h3 id="time-dependent-foi-model">3.3.2. Time-dependent FOI Model<a class="anchor" aria-label="anchor" href="#time-dependent-foi-model"></a></h3>
<p>Currently, <strong>serofoi</strong> allows the implementation of two
time-dependent models: one for slow variation of FoI
(<strong>time</strong>) and one for fast variation
(<strong>time-log</strong>) of FoI.</p>
<p>Each of them is based on different prior distributions for <span class="math inline">\(lambda\)</span>, which are shown in Table 1.</p>
<table class="table"><colgroup><col width="6%"><col width="11%"><col width="27%"><col width="53%"></colgroup><thead><tr class="header"><th>Model Type</th>
<th>Model Type</th>
<th>Logarithmic Scale</th>
<th>Probability of positive case at age <span class="math inline">\(a\)</span>
</th>
</tr></thead><tbody><tr class="odd"><td><code>"constant"</code></td>
<td><code>FALSE</code></td>
<td><span class="math inline">\(\sim binom(n(a,t), P(a,t))\)</span></td>
<td><span class="math inline">\(\lambda\sim uniform(0,2)\)</span></td>
</tr><tr class="even"><td><code>"time"</code></td>
<td><code>FALSE</code></td>
<td><span class="math inline">\(\sim binom(n(a,t), P(a,t))\)</span></td>
<td><span class="math inline">\(\lambda\sim normal(\lambda(t-1),\sigma)\
\lambda(t=1)\sim normal(0,1)\)</span></td>
</tr><tr class="odd"><td><code>"time"</code></td>
<td><code>TRUE</code></td>
<td><span class="math inline">\(\sim binom(n(a,t), P(a,t))\)</span></td>
<td><span class="math inline">\(\lambda\sim
normal(log(\lambda(t-1)),\sigma)\ \lambda(t=1)\sim
normal(-6,4)\)</span></td>
</tr></tbody></table><p><strong>Table 1.</strong> A priori distributions of the different
models supported by <strong>serofoi</strong>. <span class="math inline">\(sigma\)</span> represents the standard
deviation.</p>
<p>As can be seen, the prior distributions of <span class="math inline">\(\lambda\)</span> in both cases are given by
Gaussian distributions with standard deviation <span class="math inline">\(\sigma\)</span> and centered on <span class="math inline">\(\lambda\)</span> (slow-variation model -
<code>"time"</code>) and <span class="math inline">\(\log(\lambda)\)</span> (fast-variation model -
<code>"time"</code> with <code>is_log_foi = TRUE</code>). Thus, the FoI
at time <span class="math inline">\(t\)</span> is distributed according
to a normal distribution around the value it had at the immediately
preceding time. The logarithm in the <span class="math inline">\(log(\lambda)\)</span> model allows to identify
drastic changes in the time trend of FoI.</p>
</div>
<div class="section level3">
<h3 id="workshop-content">Workshop content<a class="anchor" aria-label="anchor" href="#workshop-content"></a></h3>
<!-- Here you should add the content of the workshop. Be clear. Test the codes. Remember that while you will be there to lead the workshop, the workshop must be clear in order to be run. -->
<div class="section level4">
<h4 id="serofoi-installation">4.1 <strong>serofoi</strong> installation<a class="anchor" aria-label="anchor" href="#serofoi-installation"></a></h4>
<p>Prior to the installation of <strong>serofoi</strong>, create an R
project in the folder of your choice on your local machine; this in
order to organize the workspace where the codes you develop during the
session will be stored.</p>
<p>Before installing <strong>serofoi</strong>, it is necessary to
install and configure C++ Toolchain (instructions for <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">windows</a>/ <a href="https://github.com/stan-dev/rstan/wiki/Configuring-C---Toolchain-for-Mac" class="external-link">mac</a>/
<a href="https://github.com/stan-dev/rstan/wiki/Configuring-C-Toolchain-for-Linux" class="external-link">linux</a>).</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> how to install and configure Rtools in Windows? </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Windows users will need a working installation of <code>Rtools</code>
in order to build the package from source. <code>Rtools</code> is not an
R package, but a software you need to download and install. We suggest
you to follow:</p>
<!-- reference [these steps](http://jtleek.com/modules/01_DataScientistToolbox/02_10_rtools/#1) -->
<ol style="list-style-type: decimal"><li>
<strong>Verify <code>Rtools</code> installation</strong>. You can do
so by using Windows search across your system. Optionally, you can use
<a href="https://devtools.r-lib.org/" class="external-link">devtools</a> running:</li>
</ol><div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">find_rtools</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>If the result is <code>FALSE</code>, then you should do step 2.</p>
<ol start="2" style="list-style-type: decimal"><li><p><strong>Install <code>Rtools</code></strong>. Download the
<code>Rtools</code> installer from <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/</a>. Install
with default selections.</p></li>
<li><p><strong>Verify <code>Rtools</code> installation</strong>. Again,
we can use <a href="https://devtools.r-lib.org/" class="external-link">devtools</a>:</p></li>
</ol><div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">find_rtools</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>After you have configured C++ Toolchain, run the following lines of
code to install the package:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="st">"serofoi"</span><span class="op">)</span></span></code></pre>
</div>
<p>If you get an error, your can try:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"serofoi"</span><span class="op">)</span></span></code></pre>
</div>
<p>Optionally, it is possible to modify the R configuration so that the
models to be implemented run in parallel, taking advantage of the
processor cores of your computer. This has the effect of reducing the
computation time of the implementations in Stan. To activate this option
run:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">options</span><span class="op">(</span>mc.cores<span class="op">=</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Finally, load the package by running</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">serofoi</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="use-case-chikungunya">4.2 Use case: Chikungunya<a class="anchor" aria-label="anchor" href="#use-case-chikungunya"></a></h4>
<p>In this section we will analyze a serological survey conducted
between October and December 2015 in Bahia, Brazil, which was carried
out shortly after an epidemic of this disease in the area. Our objective
is to characterize the spread of the disease by implementing the
different models and determine which of these best describes the
situation. First, let us load and prepare the data that we will use in
this analysis. The database <code>chik2015</code> contains the data
corresponding to this serological survey:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data</span><span class="op">(</span><span class="va">chik2015</span><span class="op">)</span></span>
<span><span class="va">chik2015</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  survey_year n_sample n_seropositive age_min age_max
1        2015      144             63      40      59
2        2015      148             69      60      79
3        2015       45             17       1      19
4        2015      109             55      20      39</code></pre>
</div>
<p>To run the constant FoI model and visualize the results of the model,
run the following lines of code:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chik_constant</span> <span class="op">&lt;-</span> <span class="fu">fit_seromodel</span><span class="op">(</span>serosurvey <span class="op">=</span> <span class="va">chik2015</span>,</span>
<span>                               model_type <span class="op">=</span> <span class="st">"constant"</span>,</span>
<span>                               iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chik_constant_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_seromodel</span><span class="op">(</span>seromodel <span class="op">=</span> <span class="va">chik_constant</span>,</span>
<span>                                     serosurvey <span class="op">=</span> <span class="va">chik2015</span>,</span>
<span>                                     size_text <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre>
</div>
<p>Now, run the time-dependent models with <code>iter =1500</code>. Then
visualize the three plots together using the <code>plot_grid()</code>
function of the <code>cowplot</code> package:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"cowplot"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">chik_constant_plot</span>,</span>
<span>                   <span class="va">chik_normal_plot</span>,</span>
<span>                   <span class="va">chik_normal_log_plot</span>,</span>
<span>                   ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p><strong>NOTE:</strong> . Because the number of trajectories is
relatively high, in order to ensure convergence of the models, the
computation time of the time-dependent models may take several
minutes.</p>
<p>Hint: You should get the following graph: * Hint: You should get the
following graph: * Hint: You should get the following graph</p>
<figure><img src="fig/Serofoi-tutorial-rendered-chik2015_vis-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The predictive power of a Bayesian model can be characterized by the
<em>elpd</em>(Expected Log Predictive Density). The model that best fits
the epidemiological survey is the one that has higher values of
<em>elpd</em> and lower values of standard error (se).</p>

</div>
</div>
</section><section><h2 class="section-heading" id="reflection">5. Reflection<a class="anchor" aria-label="anchor" href="#reflection"></a></h2>
<hr class="half-width"><!-- Here it is expected to include questions/activities that allow the group to reflect on the scope and limitations of what has been learned in the resolution of the problem exposed in the workshop. As well as reflections that lead to better learning and application to the field of public health. --><div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p>According to the criteria explained above, please answer:</p>
<ul><li><p>Which of the three models best fits this serological
survey?</p></li>
<li><p>How do you interpret these results?</p></li>
</ul></div>
</div>
</div>

<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Challenge: simulated case</strong></p>
<p>In the past 3 years, cases of encephalitis of unknown origin have
been identified in humans in rural border areas of two neighboring Latin
American countries. Some of these cases of encephalitis have required
hospitalization and even deaths have been reported. Locals also point
out that a similar epidemic of cases in which people*“lost consciousness
after a high fever”* had occurred in the same area a few decades
earlier.</p>
<p>In 2023, a seroprevalence survey was conducted for the 4 viruses most
suspected to be circulating in the border area where encephalitis cases
occur. These 4 viruses are biologically distinct from each other,
i.e. they do not cross-react in serological tests. For each of these
viruses, the seroprevalence survey collected a probabilistic and
representative sample of the population of residents of the area with a
total of 1306 individuals sampled between 1 and 60 years of age. The
results of the serological tests for each virus are presented as the
total number of people sampled for each age group and the number of
people positive for IgG antibodies against one of the 4 viruses in that
age group.</p>
<p>The challenge is for you and your group to identify which of the 4
viruses is most likely to be involved in this viral encephalitis
emergency using the serofoi library.</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p><strong>Data exploration and visualization of seroprevalence (30
min)</strong>.</p>
<p>The data from the 4 surveys come in separate . RDS files that you can
find in these links:</p>
<ul><li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_01.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_01.RDS</a></li>
<li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_02.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_02.RDS</a></li>
<li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_03.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_03.RDS</a></li>
<li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_04.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_04.RDS</a></li>
</ul><p>Read the data using the <code>readRDS()</code> function. At this
stage of the challenge you are expected to:</p>
<ol style="list-style-type: decimal"><li><p>Explore the structure of the data and discuss the general
characteristics of an age-disaggregated cross-sectional serological
survey.</p></li>
<li><p>Prepare the data for the visualization process by means of
functions from the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> package.</p></li>
</ol><p>Visualize the seroprevalence of each survey by means of the
<code>plot_seroprev()</code> function and qualitatively analyze its
trend in each case.</p>
</div>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Give me a hint </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p><strong>Estimation of the historical force of infection (30
min)</strong>.</p>
<p>Implement the models you consider relevant to each serological survey
and compare the results obtained using Bayesian comparison metrics. At
this stage it is expected that:</p>
<p>Implement the Bayesian models available in serofoi by means of the
<code>fit_seromodel()</code>function. How does using more or fewer
iterations affect your results?</p>
<ol start="2" style="list-style-type: decimal"><li>Comparison of the fits obtained by means of the
<code>plot_seromodel()</code> function. Which model fits best in each
case?</li>
</ol><p><strong>Results analysis (30 min)</strong></p>
<p>Based on the results obtained above, which virus do you think was
involved in the recent encephalitis epidemic?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>To adapt one of the four databases to the format required for
{serofoi}, you can use the following code:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">virus_serosurvey</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/epimodelac/data/serosurvey_01.RDS"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span></span>
<span>    age_group <span class="op">=</span> <span class="fu">vaccineff</span><span class="fu">::</span><span class="fu">get_age_group</span><span class="op">(</span></span>
<span>      data_set <span class="op">=</span> <span class="va">.</span>,</span>
<span>      col_age <span class="op">=</span> <span class="st">"age_max"</span>,</span>
<span>      max_val <span class="op">=</span> <span class="fl">60</span>,</span>
<span>      step <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">group_by</span><span class="op">(</span><span class="va">age_group</span>, survey_year <span class="op">=</span> <span class="va">tsur</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">summarise</span><span class="op">(</span></span>
<span>    n_sample <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">total</span><span class="op">)</span>,</span>
<span>    n_seropositive <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span>,</span>
<span>    age_min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">age_min</span><span class="op">)</span>,</span>
<span>    age_max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">age_max</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">age_group</span><span class="op">)</span></span></code></pre>
</div>
<p>Now, how would you implement the Bayesian models available in serofoi
via the <code>fit_seromodel()</code> function?</p>
</div>
</div>
</div>
</div>

<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<p>Check if you have acquired these competencies at the end of this
lesson:</p>
<ul><li><p>Explore and analyze a typical serological survey.</p></li>
<li><p>Learn how to estimate the Infection Strength in a specific use
case.</p></li>
<li><p>Visualize and interpret the results.</p></li>
</ul></div>
</div>
</div>
<div class="section level3">
<h3 id="about-this-document">About this document<a class="anchor" aria-label="anchor" href="#about-this-document"></a></h3>
<p>This document has been designed for the International Course:
Outbreak Analysis and Modeling in Public Health, Bogotá 2023.
TRACE-LAC/Javeriana.</p>
<div class="section level4">
<h4 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a></h4>
<ul><li>Nicolás Torres Domínguez</li>
<li>Zulma M. Cucunuba</li>
</ul><p>Contributions are welcome via <a href="https://github.com/reconhub/learn/pulls" class="external-link">pull requests</a>.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
<hr class="half-width"><p>Muench, H. (1959). Catalytic models in epidemiology. Harvard
University Press.</p>
<p>Hens, N., Aerts, M., Faes, C., Shkedy, Z., Lejeune, O., Van Damme,
P., Beutels, P. (2010). Seventy-five years of estimating the force of
infection from current status data. Epidemiology &amp; Infection,
138(6), 802-812.</p>
<p>Cucunubá, Z. M., Nouvellet, P., Conteh, L., Vera, M. J., Angulo, V.
M., Dib, J. C., … Basáñez, M. G. (2017). Modelling historical changes in
the force-of-infection of Chagas disease to inform control and
elimination programmes: application in Colombia. BMJ Global Health,
2(3). <a href="doi:10.1136/bmjgh-2017-000345" class="uri">doi:10.1136/bmjgh-2017-000345</a>.</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/epimodelac-en/edit/main/episodes/Serofoi-tutorial.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/epimodelac-en/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/epimodelac-en/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/epimodelac-en/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:gomezblaura@javeriana.edu.co">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.7.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://epiverse-trace.github.io/epimodelac-en/Serofoi-tutorial.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Estimation of force of infection from serological surveys using serofoi",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/epimodelac-en/Serofoi-tutorial.html",
  "identifier": "https://epiverse-trace.github.io/epimodelac-en/Serofoi-tutorial.html",
  "dateCreated": "2023-11-10",
  "dateModified": "2025-06-26",
  "datePublished": "2025-07-15"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

