<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Outbreak Analytics and Modelling in Public Health: Estima la fuerza de infección a partir de encuestas serológicas usando serofoi</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epiverse-trace/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/epiverse-trace/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/epiverse-trace/favicon-16x16.png"><link rel="manifest" href="favicons/epiverse-trace/site.webmanifest"><link rel="mask-icon" href="favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/Serofoi-tutorial.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Outbreak Analytics and Modelling in Public Health
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Outbreak Analytics and Modelling in Public Health
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Outbreak Analytics and Modelling in Public Health
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 67%" class="percentage">
    67%
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: 67%" aria-valuenow="67" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/Serofoi-tutorial.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="TallerIntroAnaliticaBrotes.html">1. Introducción a la analítica de brotes</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="ZIKAB.html">2. Construyendo un modelo matemático simple para Zika</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="EnfermedadX.html">3. Estimación de las distribuciones de rezagos epidemiológicos: Enfermedad X</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="Sivirep-tutorial.html">4. Generar reportes a partir de bases de datos de vigilancia epidemiológica usando sivirep</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Estima la fuerza de infección a partir de encuestas serológicas usando serofoi
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introducci%C3%B3n">1. Introducción</a></li>
<li><a href="#objetivos">2. Objetivos</a></li>
<li><a href="#conceptos-b%C3%A1sicos-a-desarrollar">3. Conceptos básicos a desarrollar</a></li>
<li><a href="#modelos-bayesianos">3.2. Modelos Bayesianos</a></li>
<li><a href="#reflexi%C3%B3n">5. Reflexión</a></li>
<li><a href="#referencias">Referencias</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="Vaccineff-tutorial.html">6. Introducción al cálculo de efectividad vacunal con cohortes usando vaccineff</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="epiCo-tutorial.html">7. Indicadores demográficos, canales endémicos y clusters de incidencia usando epiCo</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="Sivirep-tutorial.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Vaccineff-tutorial.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="Sivirep-tutorial.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Generar reportes a
        </a>
        <a class="chapter-link float-end" href="Vaccineff-tutorial.html" rel="next">
          Next: Introducción al...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Estima la fuerza de infección a partir de encuestas serológicas usando serofoi</h1>
        <p>Last updated on 2025-06-16 |

        <a href="https://github.com/epiverse-trace-en/epimodelac/edit/main/episodes/Serofoi-tutorial.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>¿Cómo estimar retrospectivamente la <em>Fuerza de Infección</em> de
un patógeno a partir de <em>encuestas serológicas poblacionales de
prevalencia desagregadas por edad</em> mediante la implementación de
<em>modelos Bayesianos</em> usando <strong>serofoi</strong>?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>Al final de este taller usted podrá:</p>
<ul><li><p>Explorar y analizar una encuesta serológica típica.</p></li>
<li><p>Aprender a estimar la Fuerza de Infección en un caso de uso
específico.</p></li>
<li><p>Visualizar e interpretar los resultados.</p></li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introducción">1. Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a></h2>
<hr class="half-width"><!-- Aquí se espera que usted comparta información sobre un problema de salud pública. La metodología es de resolución de casos.
(También es posible pedir a los participantes que describan la base de datos)
--><p><strong>serofoi</strong> es un paquete de R para estimar
retrospectivamente la <em>Fuerza de Infección</em> de un patógeno a
partir de <em>encuestas serológicas poblacionales de prevalencia
desagregadas por edad</em> mediante la implementación de <em>modelos
Bayesianos</em>. Para ello, <strong>serofoi</strong> utiliza el paquete
<em>Rstan</em>, que proporciona una interfaz para el lenguaje de
programación estadística <em>Stan</em>, mediante el cual se implementan
métodos de Monte-Carlo basados en cadenas de Markov.</p>
<p>Como un caso particular, estudiaremos un brote de Chikungunya, una
enfermedad viral descubierta en Tanzania en el año 1952 que se
caracteriza por causar fuertes fiebres, dolor articular, jaqueca,
sarpullidos, entre otros síntomas. Desde el año 2013, casos de esta
enfermedad comenzaron a ser reportados en América y desde entonces la
enfermedad ha sido endémica en varios países latinoamericanos. Durante
este tutorial, vamos a analizar una encuesta serológica realizada entre
octubre y diciembre de 2015 en Bahía, Brasil, la cual fue realizada poco
tiempo después de una epidemia de esta enfermedad, con el fin de
caracterizar los patrones endémicos o epidémicos en la zona.</p>
</section><section><h2 class="section-heading" id="objetivos">2. Objetivos<a class="anchor" aria-label="anchor" href="#objetivos"></a></h2>
<hr class="half-width"><!-- Aquí se espera que usted incluya los objetivos del taller. ¿Qué es lo que usted espera que los estudiantes aprendan del taller? ¿Qué se espera que los estudiantes puedan hacer al terminar el taller? Los objetivos deben empezar con un verbo en infinitivo. --><ul><li><p>Explorar y analizar una encuesta serológica típica.</p></li>
<li><p>Aprender a estimar la Fuerza de Infección en un caso de uso
específico.</p></li>
<li><p>Visualizar e interpretar los resultados.</p></li>
</ul></section><section><h2 class="section-heading" id="conceptos-básicos-a-desarrollar">3. Conceptos básicos a desarrollar<a class="anchor" aria-label="anchor" href="#conceptos-b%C3%A1sicos-a-desarrollar"></a></h2>
<hr class="half-width"><!-- En esta práctica se desarrollarán los siguientes conceptos: --><!-- Aquí se espera que usted mencione los conceptos más importantes del taller (deben ser conceptos técnicos que se puedan encontrar en la literatura) --><p>En esta práctica se desarrollarán los siguientes conceptos:</p>
<ul><li><p>Encuestas serologícas (<em>sero</em>)</p></li>
<li><p>Fuerza de infección (<em>foi</em>)</p></li>
<li><p>Modelos serocatalíticos</p></li>
<li><p>Estadística Bayesiana</p></li>
<li><p>Visualización e interpretación de resultados de modelos
FoI</p></li>
</ul><p>La Fuerza de Infección (FoI, por sus siglas en inglés), también
conocida cómo la tasa de riesgo o la presión de infección, representa la
tasa a la que los individuos susceptibles se infectan dado que
estuvieron expuestos a un patógeno. En otras palabras, la FoI cuantifica
el riesgo de que un individuo susceptible se infecte en un periodo de
tiempo.</p>
<p>Como veremos a continuación, este concepto es clave en el
modelamiento de enfermedades infecciosas. Para ilustrar el concepto,
consideremos una población expuesta a un patógeno y llamemos <span class="math inline">\(P(t)\)</span> a la proporción de individuos que
han sido infectados al tiempo <span class="math inline">\(t\)</span>.
Suponiendo que no hay sero-reversión, la cantidad <span class="math inline">\(1 - P(t)\)</span> representa la cantidad de
individuos susceptibles a la enfermedad, de tal forma que la velocidad
de infección está dada por:</p>
<p><span class="math display">\[
\tag{1} \frac{dP(t)}{d t} = \lambda(t) (1- P(t)),
\]</span></p>
<p>en donde <span class="math inline">\(\lambda(t)\)</span> representa
la tasa a la que los individuos susceptibles se infectan por unidad de
tiempo (días, meses, años, …), es decir la FoI. La ecuación diferencial
(1) se asemeja a la de una reacción química en donde <span class="math inline">\(P(t)\)</span> representa la proporción de sustrato
que no ha entrado en contacto con un reactivo catalítico, por lo que
este tipo de modelos se conocen como <strong>modelos
serocatalíticos</strong> (Muench, 1959).</p>
<p>A pesar de la simpleza del modelo representado por la ecuación (1),
en comparación con modelos compartimentales (por ejemplo), la dificultad
para conocer una condición inicial para la seropositividad en algún
punto del pasado imposibilita su uso práctico. Para sortear esta
limitación, es común aplicar el modelo para cohortes de edad en lugar de
para el total de la población. Para ello, etiquetemos cada cohorte de
edad de acuerdo con su año de nacimiento <span class="math inline">\(\tau\)</span>, y supongamos que los individuos son
seronegativos al nacer:</p>
<p><span class="math display">\[
\frac{dP^\tau (t)}{dt} = \lambda(t) (1 - P^\tau(t)).
\]</span></p>
<p>Con condiciones iniciales dadas por <span class="math inline">\(P^\tau(\tau) = 0\)</span>. Esta ecuación se puede
resolver analíticamente, dando como resultado (Hens et al, 2010):</p>
<p><span class="math display">\[
P^{\tau} (t) = 1 - \exp\left(-\int_{\tau}^{t} \lambda (t') dt'
\right).
\]</span></p>
<p>Suponiendo que la FoI se mantiene constante a lo largo de cada año,
la versión discreta de esta ecuación es:</p>
<p><span class="math display">\[
\tag{2}
P^\tau(t) = 1 - \exp\left(-\sum_{i = \tau}^{t} \lambda_i \right),
\]</span></p>
<p>Como un ejemplo, consideremos la FoI representada en la siguiente
figura:</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>A partir de esta FoI, es posible calcular la seroprevalencia para
distintas cohortes por medio de la ecuación (2):</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Cuando conocemos los datos de una encuesta serológica, la información
a la que tenemos acceso es a una fotografía de la seroprevalencia en el
momento su realización <span class="math inline">\(t_{sur}\)</span> como
función de la edad de los individuos en ese momento, la cual coincide
con la ecuación (2) ya que los individuos envejecen al mismo ritmo al
que pasa el tiempo; es decir:</p>
<p><span class="math display">\[
\tag{3}
P^{t_{sur}}(a^\tau) = 1 - \exp\left(-\sum_{i = \tau}^{t_{sur}} \lambda_i
\right).
\]</span></p>
<p>En el caso del ejemplo, esto nos da la siguiente gráfica:</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note que los valores de seroprevalencia de cada edad en esta gráfica
corresponden a los valores de seroprevalencia al momento de la encuesta
(2020) en la gráfica anterior.</p>
<p>La misión que cumple <strong>serofoi</strong> es estimar la fuerza de
infección histórica <span class="math inline">\(\lambda(t)\)</span> a
partir de esta fotografía del perfil serológico de la población al
momento de la encuesta. para lo cual se requieren encuestas serológicas
que cumplan con los siguientes criterios de inclusión:</p>
<ul><li>Basadas en poblacionales (no hospitalaria).</li>
<li>Estudio de tipo transversal (un solo tiempo) .</li>
<li>Que indique la prueba diagnóstica utilizada.</li>
<li>Que identifique la edad del paciente en el momento de la
encuesta.</li>
</ul><p>En casos donde la FoI pueda considerarse constante, la ecuación (3)
da como resultado:</p>
<p><span class="math display">\[
\tag{4}
P_{sur}(a^\tau(t_{sur})) = 1 - \exp (-\lambda a^\tau),
\]</span></p>
<p>en donde se tuvo en cuenta qué, al momento de la introducción del
patógeno (<span class="math inline">\(t = 0\)</span>), la proporción de
individuos infectados fue <span class="math inline">\(P(0) = 0\)</span>
(condición inicial). Note que el término de la suma en la ecuación (3)
da como resultado la edad de cada cohorte al considerar la fuerza de
infección constante.</p>
<figure><img src="fig/Serofoi-tutorial-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>Figura 1.</strong> Curvas de prevalencia en función de la
edad para distintos valores de FoI constante.</p>
<p>En este ejemplo hemos escogido, por simplicidad, que la FoI fuese
constante; sin embargo, este no es necesariamente el caso. Identificar
si la FoI sigue una tendencia constante o variante en el tiempo puede
ser de vital importancia para la identificación y caracterización de la
propagación de una enfermedad. Es acá donde el paquete de
R<strong>serofoi</strong> juega un papel importante, ya que este permite
estimar retrospectivamente la FoI de un patógeno, recuperando así su
evolución temporal, por medio de modelos Bayesianos
pre-establecidos.</p>
<p>Los modelos actuales del paquete <strong>serofoi</strong> asumen los
siguientes supuestos biológicos:</p>
<ul><li>No hay sero-reversión (sin pérdida de inmunidad).</li>
<li>La FoI no depende de la edad.</li>
<li>Bajos o nulos niveles de migración en las poblaciones.</li>
<li>Diferencias pequeñas entre las tasas de mortalidad de susceptibles e
infectados.</li>
</ul></section><section><h2 class="section-heading" id="modelos-bayesianos">3.2. Modelos Bayesianos<a class="anchor" aria-label="anchor" href="#modelos-bayesianos"></a></h2>
<hr class="half-width"><p>A diferencia del enfoque frecuentista, donde la probabilidad se
asocia con la frecuencia relativa de la ocurrencia de los eventos, la
estadística Bayesiana se basa en el uso de la probabilidad condicional
de los eventos respecto al conocimiento (o estado de información) que
podamos tener sobre los datos o sobre los parámetros que queramos
estimar.</p>
<p>Por lo general, cuando proponemos un modelo lo que buscamos es
disminuir la incertidumbre sobre algún parámetro, de tal forma que nos
aproximemos a su valor tan óptimamente como nos lo permita nuestro
conocimiento previo del fenómeno y de las mediciones realizadas
(datos).</p>
<p>La inferencia Bayesiana se sustenta en el teorema de Bayes, el cual
establece que: dado un conjunto de datos <span class="math inline">\(\vec{y} = (y_1, …, y_N)\)</span>, el cual
representa un único evento, y la variable aleatoria <span class="math inline">\(\theta\)</span>, que representa un parámetro de
interés para nosotros (en nuestro caso, la FoI <span class="math inline">\(\lambda\)</span>), la distribución de probabilidad
conjunta de las variables aleatorias asociadas está dada por:</p>
<p><span class="math display">\[ \tag{4}
p(\vec{y}, \theta) = p(\vec{y} | \theta) p(\theta) = p(\theta | \vec{y})
p(\vec{y}),
\]</span></p>
<p>de donde se desprende la distribución aposteriori de <span class="math inline">\(\theta\)</span>, es decir una versión actualizada
de la distribución de probabilidad de la FoI condicionada a nuestros
datos:</p>
<p><span class="math display">\[\tag{5}
p(\theta, \vec{y}) =  \frac{p(\vec{y} | \theta) p(\theta)}{p(\vec{y})},
\]</span></p>
<p>La distribución <span class="math inline">\(p(\vec{y} |
\theta)\)</span>, que corresponde a la información interna a los datos
condicionada al valor del parámetro <span class="math inline">\(\theta\)</span>, suele estar determinada por la
naturaleza del experimento: no es lo mismo escoger pelotas dentro de una
caja reemplazándolas que dejándolas por fuera de la caja (e.g.). En el
caso particular de la FoI, contamos con datos como el número total de
encuestas por edad y el número de casos positivos, por lo que es
razonable asignar una distribución binomial a la probabilidad, como
veremos a continuación.</p>
<div class="section level3">
<h3 id="modelo-foi-constante">3.3.1. Modelo FoI constante<a class="anchor" aria-label="anchor" href="#modelo-foi-constante"></a></h3>
<p>En nuestro caso particular, el parámetro que queremos estimar es la
FoI (<span class="math inline">\(\lambda\)</span>). La distribución de
probabilidad apriori de <span class="math inline">\(\lambda\)</span>
representa nuestras suposiciones informadas o el conocimiento previo que
tengamos sobre el comportamiento de la FoI. En este contexto, el estado
de mínima información sobre <span class="math inline">\(\lambda\)</span>
está representado por una distribución uniforme:</p>
<p><span class="math display">\[\tag{6}
\lambda \sim U(0, 2),
\]</span></p>
<p>lo que significa que partimos de la premisa de que todos los valores
de la fuerza de infección entre <span class="math inline">\(0\)</span> y
<span class="math inline">\(2\)</span> son igualmente probables. Por
otro lado, de la teoría de modelos sero-catalíticos sabemos que la
seroprevalencia en un año dado está descrita por un proceso cumulativo
con la edad (Hens et al, 2010):</p>
<p><span class="math display">\[\tag{7}
P(a, t) = 1 - \exp\left(  -\sum_{i=t-a+1}^{t} \lambda_i  \right),
\]</span></p>
<p>en donde <span class="math inline">\(\lambda_i\)</span> corresponde a
la FoI al tiempo <span class="math inline">\(t\)</span>. Como en este
caso la FoI es constante, la ec. (7) se reduce a:</p>
<p><span class="math display">\[\tag{8}
P(a, t) = 1 - \exp\left(  -\lambda a \right),
\]</span></p>
<p>Si <span class="math inline">\(n(a, t_{sur})\)</span> es el número de
muestras positivas por edad obtenidas en un estudio serológico
desarrollado en el año <span class="math inline">\(t_{sur}\)</span>,
entonces podemos estimar la distribución de los casos seropositivos por
edad condicionada al valor de <span class="math inline">\(\lambda\)</span> como una distribución
binomial:</p>
<p><span class="math display">\[\tag{9}
p(a, t) \sim Binom(n(a, t), P(a, t)) \\
\lambda \sim U(0, 2)
\]</span></p>
</div>
<div class="section level3">
<h3 id="modelo-foi-dependientes-del-tiempo">3.3.2. Modelo FOI dependientes del tiempo<a class="anchor" aria-label="anchor" href="#modelo-foi-dependientes-del-tiempo"></a></h3>
<p>Actualmente, <strong>serofoi</strong> permite la implementación de
dos modelos dependientes del tiempo: uno de variación lenta de la FoI
(<strong>time</strong>) y otro de variación rápida
(<strong>time-log</strong>) de la FoI.</p>
<p>Cada uno de ellos se basa en distintas distribuciones previas para
<span class="math inline">\(\lambda\)</span>, las cuales se muestran en
la tabla 1.</p>
<table class="table"><colgroup><col width="6%"><col width="11%"><col width="27%"><col width="53%"></colgroup><thead><tr class="header"><th>Model Type</th>
<th>Logarithmic Scale</th>
<th>Probability of positive case at age <span class="math inline">\(a\)</span>
</th>
<th>Prior distribution</th>
</tr></thead><tbody><tr class="odd"><td><code>"constant"</code></td>
<td><code>FALSE</code></td>
<td><span class="math inline">\(\sim binom(n(a,t), P(a,t))\)</span></td>
<td><span class="math inline">\(\lambda\sim uniform(0,2)\)</span></td>
</tr><tr class="even"><td><code>"time"</code></td>
<td><code>FALSE</code></td>
<td><span class="math inline">\(\sim binom(n(a,t), P(a,t))\)</span></td>
<td><span class="math inline">\(\lambda\sim normal(\lambda(t-1),\sigma)\
\lambda(t=1)\sim normal(0,1)\)</span></td>
</tr><tr class="odd"><td><code>"time"</code></td>
<td><code>TRUE</code></td>
<td><span class="math inline">\(\sim binom(n(a,t), P(a,t))\)</span></td>
<td><span class="math inline">\(\lambda\sim
normal(log(\lambda(t-1)),\sigma)\ \lambda(t=1)\sim
normal(-6,4)\)</span></td>
</tr></tbody></table><p><strong>Tabla 1.</strong> Distribuciones a priori de los distintos
modelos soportados por <strong>serofoi</strong>. <span class="math inline">\(\sigma\)</span> representa la desviación
estándar.</p>
<p>Como se puede observar, las distribuciones previas de <span class="math inline">\(\lambda\)</span> en ambos casos están dadas por
distribuciones Gaussianas con desviación estándar <span class="math inline">\(\sigma\)</span> y centradas en <span class="math inline">\(\lambda\)</span> (modelo de variación lenta -
<code>"time"</code>) y <span class="math inline">\(\log(\lambda)\)</span> (modelo de variación rápida
- <code>"time"</code> con <code>is_log_foi = TRUE</code>). De esta
manera, la FoI en un tiempo <span class="math inline">\(t\)</span> está
distribuida de acuerdo a una distribución normal alrededor del valor que
esta tenía en el tiempo inmediatamente anterior. El logaritmo en el
modelo <span class="math inline">\(\log(\lambda)\)</span> permite
identificar cambios drásticos en la tendencia temporal de la FoI.</p>
</div>
<div class="section level3">
<h3 id="contenido-del-taller">4. Contenido del taller<a class="anchor" aria-label="anchor" href="#contenido-del-taller"></a></h3>
<!-- Aquí debe agregar el contenido del taller. Sea claro. Pruebe los códigos. Recuerde que si bien estará usted para dirigir el taller, el taller debe ser claro para poder ser ejecutado. -->
<div class="section level4">
<h4 id="instalación-de-serofoi">4.1 Instalación de <strong>serofoi</strong>
<a class="anchor" aria-label="anchor" href="#instalaci%C3%B3n-de-serofoi"></a></h4>
<p>Previo a la instalación de <strong>serofoi</strong>, cree un proyecto
en R en la carpeta de su escogencia en su máquina local; esto con el fin
de organizar el espacio de trabajo en donde se guardarán los códigos que
desarrolle durante la sesión.</p>
<p>Antes de realizar la instalación de <strong>serofoi</strong>, es
necesario instalar y configurar C++ Toolchain (instrucciones para <a href="https://github.com/stan-dev/rstan/wiki/Configuring-C---Toolchain-for-Windows" class="external-link">windows</a>/
<a href="https://github.com/stan-dev/rstan/wiki/Configuring-C---Toolchain-for-Mac" class="external-link">mac</a>/
<a href="https://github.com/stan-dev/rstan/wiki/Configuring-C-Toolchain-for-Linux" class="external-link">linux</a>).
Después de haber configurado C++ Toolchain, ejecute las siguientes
líneas de código para instalar el paquete:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="st">"epiverse-trace/serofoi"</span><span class="op">)</span></span></code></pre>
</div>
<p>Opcionalmente, es posible modificar la configuración de R para que
los modelos a implementar corran en paralelo, aprovechando los núcleos
del procesador de su computador. Esto tiene el efecto de disminuir los
tiempos de cómputo de las implementaciones en Stan. Para activar esta
opción ejecute:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">options</span><span class="op">(</span>mc.cores<span class="op">=</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Finalmente, cargue el paquete ejecutando:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">serofoi</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="caso-de-uso-chikungunya">4.2 Caso de uso: Chikungunya<a class="anchor" aria-label="anchor" href="#caso-de-uso-chikungunya"></a></h4>
<p>En esta sección vamos a analizar una encuesta serológica realizada
entre octubre y diciembre de 2015 en Bahía, Brasil, la cual fue
realizada poco tiempo después de una epidemia de esta enfermedad en la
zona. Nuestro objetivo es caracterizar la propagación de la enfermedad
por medio de la implementación de los distintos modelos y determinar
cuál de estos describe mejor la situación. Primero, carguemos y
preparemos los datos que utilizaremos en este análisis. La
base<code>chik2015</code> contiene los datos correspondientes a esta
encuesta serológica:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data</span><span class="op">(</span><span class="va">chik2015</span><span class="op">)</span></span>
<span><span class="va">chik2015</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  survey_year n_sample n_seropositive age_min age_max
1        2015      144             63      40      59
2        2015      148             69      60      79
3        2015       45             17       1      19
4        2015      109             55      20      39</code></pre>
</div>
<p>Para correr el modelo de FoI constante y visualizar los resultados
del mismo, corra las siguientes líneas de código:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chik_constant</span> <span class="op">&lt;-</span> <span class="fu">fit_seromodel</span><span class="op">(</span>serosurvey <span class="op">=</span> <span class="va">chik2015</span>,</span>
<span>                               model_type <span class="op">=</span> <span class="st">"constant"</span>,</span>
<span>                               iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chik_constant_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_seromodel</span><span class="op">(</span>seromodel <span class="op">=</span> <span class="va">chik_constant</span>,</span>
<span>                                     serosurvey <span class="op">=</span> <span class="va">chik2015</span>,</span>
<span>                                     size_text <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre>
</div>
<p>Ahora, corra los modelos dependientes del tiempo con
<code>iter =1500</code>. Luego visualice conjuntamente las tres gráficas
por medio de la función <code>plot_grid()</code> del paquete
<code>cowplot</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"cowplot"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">chik_constant_plot</span>,</span>
<span>                   <span class="va">chik_normal_plot</span>,</span>
<span>                   <span class="va">chik_normal_log_plot</span>,</span>
<span>                   ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p><strong>NOTA:</strong> Debido a que el número de trayectorias es
relativamente alto, con el fin de asegurar la convergencia de los
modelos, el tiempo de cómputo de los modelos dependientes del tiempo
puede tardar varios minutos.</p>
<p><em>Pista: Debería obtener la siguiente gráfica:</em></p>
<figure><img src="fig/Serofoi-tutorial-rendered-chik2015_vis-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>El poder predictivo de un modelo Bayesiano se puede caracterizar por
medio del <em>elpd</em>(Expected Log Predictive Density). El modelo que
mejor ajusta la encuesta epidemiológica es aquel que tiene valores más
altos de<em>elpd</em> y valores más bajos de error estándar (se).</p>

</div>
</div>
</section><section><h2 class="section-heading" id="reflexión">5. Reflexión<a class="anchor" aria-label="anchor" href="#reflexi%C3%B3n"></a></h2>
<hr class="half-width"><!-- Aquí se espera que incluya preguntas/actividades que permita reflexionar al grupo sobre los alcances y limitaciones de lo aprendido en la resolución del problema expuesto en el taller. Así como reflexiones que conlleven a un mejor aprendizaje y aplicación al campo de la salud pública. --><div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p>Según los criterios explicados anteriormente, responda:</p>
<ul><li><p>¿Cuál de los tres modelos se ajusta mejor a esta encuesta
serológica?</p></li>
<li><p>¿Cómo interpreta estos resultados?</p></li>
</ul></div>
</div>
</div>

<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Desafío: caso simulado</strong></p>
<p>En los pasados 3 años, en zonas rurales fronterizas de dos países
contíguos de América Latina se han identificado casos de encefalitis de
origen desconocido en humanos. Algunos de estos casos de encefalitis han
requerido hospitalización e incluso se han reportado fallecimientos. Los
habitantes de la zona también señalan que una epidemia similar de casos
en que las personas<em>“perdían la conciencia después de una fuerte
fiebre”</em> habían ocurrido en la misma zona algunas décadas atrás.</p>
<p>En 2023 se realizó una encuesta de seroprevalencia para los 4 virus
con mayor sospecha de estar circulando en la zona fronteriza donde se
presentan los casos de encefalitis. Estos 4 virus son biológicamente
distintivos entre ellos, es decir no tienen reacción cruzada en las
pruebas serológicas. Para cada uno de estos virus, la encuesta de
seroprevalencia recoge una muestra probabilística y representativa de la
población de residentes de la zona con un total de 1306 individuos
muestreados entre 1 y 60 años de edad. Los resultados de las pruebas
serológicas para cada virus se presentan como número total de personas
muestreadas por cada grupo de edad y número de personas positivas para
anticuerpos IgG contra uno de los 4 virus en ese grupo de edad.</p>
<p>El desafío consiste en que usted y su grupo deben identificar cuál o
cuáles de los 4 virus es el más probablemente implicado en esta
emergencia de encefalitis viral haciendo uso de la librería serofoi.</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p><strong>Exploración de los datos y visualización de la
seroprevalencia (30 min)</strong></p>
<p>Los datos de las 4 encuestas vienen en archivos . RDS independientes
que podrá encontrar en estos enlaces:</p>
<ul><li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_01.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_01.RDS</a></li>
<li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_02.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_02.RDS</a></li>
<li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_03.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_03.RDS</a></li>
<li><a href="https://epiverse-trace.github.io/epimodelac/data/serosurvey_04.RDS" class="external-link uri">https://epiverse-trace.github.io/epimodelac/data/serosurvey_04.RDS</a></li>
</ul><p>Lea los datos haciendo uso de la función <code>readRDS()</code>. En
esta etapa del desafío se espera que:</p>
<ol style="list-style-type: decimal"><li><p>Exploren la estructura de los datos y analicen las
características generales de una encuesta serológica transversal
desagregada por edad.</p></li>
<li><p>Preparen los datos para el proceso de visualización por medio de
funciones del paquete <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a>.</p></li>
<li><p>Visualicen la seroprevalencia de cada encuesta por medio de la
función <code>plot_seroprev()</code> y analicen cualitativamente su
tendencia en cada caso.</p></li>
</ol></div>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Give me a hint </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p><strong>Estimación de la fuerza de infección histórica (30
min)</strong></p>
<p>Implemente los modelos que considere pertinentes a cada encuesta
serológica y compare los resultados obtenidos usando métricas de
comparación Bayesianas. En esta etapa se espera que:</p>
<ol style="list-style-type: decimal"><li><p>Implementen los modelos Bayesianos disponibles en serofoi por
medio de la función <code>fit_seromodel()</code>. ¿Cómo afecta a sus
resultados usar más o menos iteraciones?</p></li>
<li><p>Comparación de los ajustes obtenidos por medio de la función
<code>plot_seromodel()</code>. ¿Cuál modelo se ajusta mejor en cada
caso?</p></li>
</ol><p><strong>Análisis de resultados (30 min)</strong></p>
<p>Con base en los resultados obtenidos anteriormente, ¿Cuál virus cree
que estuvo involucrado en la epidemia reciente de encefalitis?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Para adaptar una de las cuatro bases de datos al formato necesario
para {serofoi}, puede usar el siguiente código:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">virus_serosurvey</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/epimodelac/data/serosurvey_01.RDS"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span></span>
<span>    age_group <span class="op">=</span> <span class="fu">vaccineff</span><span class="fu">::</span><span class="fu">get_age_group</span><span class="op">(</span></span>
<span>      data_set <span class="op">=</span> <span class="va">.</span>,</span>
<span>      col_age <span class="op">=</span> <span class="st">"age_max"</span>,</span>
<span>      max_val <span class="op">=</span> <span class="fl">60</span>,</span>
<span>      step <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">group_by</span><span class="op">(</span><span class="va">age_group</span>, survey_year <span class="op">=</span> <span class="va">tsur</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">summarise</span><span class="op">(</span></span>
<span>    n_sample <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">total</span><span class="op">)</span>,</span>
<span>    n_seropositive <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span>,</span>
<span>    age_min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">age_min</span><span class="op">)</span>,</span>
<span>    age_max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">age_max</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">age_group</span><span class="op">)</span></span></code></pre>
</div>
<p>Ahora, ¿Cómo implementaría los modelos Bayesianos disponibles en
serofoi por medio de la función <code>fit_seromodel()</code>?</p>
</div>
</div>
</div>
</div>

<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<p>Revise si al final de esta lección adquirió estas competencias:</p>
<ul><li><p>Explorar y analizar una encuesta serológica típica.</p></li>
<li><p>Aprender a estimar la Fuerza de Infección en un caso de uso
específico.</p></li>
<li><p>Visualizar e interpretar los resultados.</p></li>
</ul></div>
</div>
</div>
<div class="section level3">
<h3 id="sobre-este-documento">Sobre este documento<a class="anchor" aria-label="anchor" href="#sobre-este-documento"></a></h3>
<p>Este documento ha sido diseñado para el Curso Internacional: Análisis
de Brotes y Modelamiento en Salud Pública, Bogotá 2023.
TRACE-LAC/Javeriana.</p>
<div class="section level4">
<h4 id="contribuciones">Contribuciones<a class="anchor" aria-label="anchor" href="#contribuciones"></a></h4>
<ul><li>Nicolás Torres Domínguez</li>
<li>Zulma M. Cucunuba</li>
</ul><p>Contribuciones son bienvenidas vía <a href="https://github.com/reconhub/learn/pulls" class="external-link">pull requests</a>.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="referencias">Referencias<a class="anchor" aria-label="anchor" href="#referencias"></a></h2>
<hr class="half-width"><p>Muench, H. (1959). Catalytic models in epidemiology. Harvard
University Press.</p>
<p>Hens, N., Aerts, M., Faes, C., Shkedy, Z., Lejeune, O., Van Damme,
P., &amp; Beutels, P. (2010). Seventy-five years of estimating the force
of infection from current status data. Epidemiology &amp; Infection,
138(6), 802–812.</p>
<p>Cucunubá, Z. M., Nouvellet, P., Conteh, L., Vera, M. J., Angulo, V.
M., Dib, J. C., … Basáñez, M. G. (2017). Modelling historical changes in
the force-of-infection of Chagas disease to inform control and
elimination programmes: application in Colombia. BMJ Global Health,
2(3). <a href="doi:10.1136/bmjgh-2017-000345" class="uri">doi:10.1136/bmjgh-2017-000345</a></p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="Sivirep-tutorial.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Vaccineff-tutorial.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="Sivirep-tutorial.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Generar reportes a
        </a>
        <a class="chapter-link float-end" href="Vaccineff-tutorial.html" rel="next">
          Next: Introducción al...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/epiverse-trace-en/epimodelac/edit/main/episodes/Serofoi-tutorial.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/epiverse-trace-en/epimodelac/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace-en/epimodelac/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace-en/epimodelac/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:gomezblaura@javeriana.edu.co">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.7.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://epiverse-trace-en.github.io/epimodelac/Serofoi-tutorial.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Estima la fuerza de infección a partir de encuestas serológicas usando serofoi",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace-en.github.io/epimodelac/Serofoi-tutorial.html",
  "identifier": "https://epiverse-trace-en.github.io/epimodelac/Serofoi-tutorial.html",
  "dateCreated": "2023-11-10",
  "dateModified": "2025-06-16",
  "datePublished": "2025-06-17"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

